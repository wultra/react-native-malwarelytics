
project.ext.configureMalwarelytics = { flavor, String username, String password, String customTheme = null, String customIcon = null ->

  // destination where malwarelytics configuration file will be created
  def file = new File("${buildDir}/generated/malwarelytics/MalwarelyticsConfig.java")
  new File(file.getParent()).mkdirs() // make necesarry folders

  def applicationId = [flavor.applicationId, flavor.applicationIdSuffix].findAll().join()

  def theme = "null"
  def icon = "null"

  if (customTheme != null) {
    theme = "${applicationId}.${customTheme}"
  }

  if (customIcon != null) {
    icon = "${applicationId}.${customIcon}"
  }

  // generate configuration fule.
  // note that package name of the configuration file matches the packagename of the library
  file.text = """/**
* Automatically generated file. DO NOT MODIFY
*/

package com.wultra.android.reactnative.malwarelytics;

public final class MalwarelyticsConfig implements IMalwarelyticsConfig {
  public MalwarelyticsConfig() {}
  public String getUserName() { return "${username}"; }
  public String getPassword() { return "${password}"; }
  public Integer getTheme() { return ${theme}; }
  public Integer getNotificationIcon() { return ${icon}; }
}"""

  flavor.sourceSets.findByName(flavor.getName()).java.srcDirs += [file.getParent()]
}
